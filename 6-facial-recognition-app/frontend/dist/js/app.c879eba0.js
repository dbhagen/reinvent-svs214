(function(e){function t(t){for(var n,i,s=t[0],l=t[1],c=t[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,s=1;s<a.length;s++){var l=a[s];0!==o[l]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},o={app:0},r=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("85ec"),o=a.n(n);o.a},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("Nav"),a("router-view")],1)},r=[],i={name:"App"},s=i,l=(a("034f"),a("2877")),c=Object(l["a"])(s,o,r,!1,null,null,null),u=c.exports,d=a("8c4f"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-card",{attrs:{title:"How does this work?"}},[a("b-card-text",[e._v(" This application allows you to enroll a person's face as a member of a group, then verify faces to confirm if they are registered members. ")]),a("b-button",{attrs:{to:{name:"enroll"},variant:"info",block:""}},[e._v("Enroll")]),a("b-button",{attrs:{to:{name:"verify"},variant:"primary",block:""}},[e._v("Verify")])],1),a("b-card",{staticClass:"text-center",attrs:{"bg-variant":"danger fixed-bottom","text-variant":"white",header:"Important!"}},[a("b-card-text",[e._v("This demo stores an image of your face in an S3 bucket and a derived representation in AWS Rekognition. The data is only used for this demo and isn't used for anything else. You give your consent for your image to be used for this purpose.")])],1)],1)},m=[],h={name:"Main"},f=h,g=Object(l["a"])(f,p,m,!1,null,null,null),b=g.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{name:"enroll"}},[a("img",{staticClass:"mt-4 img-fluid",attrs:{src:e.image}}),a("b-card",{staticClass:"text-center",attrs:{title:"Enroll member","bg-variant":"primary light fixed-bottom","text-variant":"white"}},[a("div",{staticClass:"innerBox d-flex justify-content-center flex-column"},[a("div",{attrs:{disabled:e.isSending}},[a("b-button",{attrs:{size:"lg",disabled:e.isSending,variant:"success",block:"",href:"#",type:"file"},on:{click:function(t){return e.$refs.file.click()}}},[e._v(e._s(e.sendButtonText))]),a("input",{ref:"file",staticStyle:{display:"none"},attrs:{id:"file",accept:"image/jpeg",type:"file"},on:{change:e.onFileChange}}),a("b-button",{attrs:{to:{name:"home"},size:"lg",disabled:e.isSending,variant:"secondary",block:""}},[e._v("Cancel")])],1)]),a("b-modal",{attrs:{centered:"","cancel-disabled":"","no-close-on-esc":"","no-close-on-backdrop":"","header-text-variant":"primary","body-text-variant":"primary",id:"modal",size:"sm",title:"Face Matcher"},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[e._v(" "+e._s(e.modalText)+" "),a("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("b-button",{staticClass:"float-right",attrs:{size:"sm",variant:"primary"},on:{click:e.cleanUp}},[e._v("Close")])],1)])],1)],1)},y=[],x=(a("99af"),a("caad"),a("ace4"),a("d3b7"),a("ac1f"),a("2532"),a("1276"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a9"),a("72f7"),a("96cf"),a("bc3a")),w=a.n(x),S={name:"Enroll",data:function(){return{image:"",sendButtonText:"Send Photo",isSending:!1,photoFilename:"",modalText:"",modalShow:!1,resultText:{INDEXED:"Success! You are enrolled.",EXISTING:"You are already enrolled.",NO_FACES:"There is no face in this photo."}}},methods:{onFileChange:function(e){var t=e.target.files||e.dataTransfer.files;t.length&&this.createImage(t[0])},createImage:function(e){var t=this;console.log("createImage: ",e);var a=new FileReader,n=5e6;a.onload=function(e){return e.target.result.includes("data:image/jpeg")?e.target.result.length>n?alert("Photo too large - max size of 5Mb"):(t.image=e.target.result,void t.uploadImage()):alert("Wrong photo type - only JPG allowed.")},a.readAsDataURL(e)},uploadImage:function(){var e,t,a,n,o,r,i,s;return regeneratorRuntime.async((function(l){while(1)switch(l.prev=l.next){case 0:return console.log("uploadImage"),this.isSending=!0,this.sendButtonText="Uploading...",l.next=5,regeneratorRuntime.awrap(w()({method:"GET",url:"".concat(this.$API,"/upload?mode=enroll")}));case 5:for(e=l.sent,console.log("Response: ",e.data),console.log("Uploading..."),t=atob(this.image.split(",")[1]),a=[],n=0;n<t.length;n++)a.push(t.charCodeAt(n));return o=new Blob([new Uint8Array(a)],{type:"image/jpeg"}),this.photoFilename=e.data.photoFilename,console.log("Uploading to: ",e.data.uploadURL),l.next=16,regeneratorRuntime.awrap(fetch(e.data.uploadURL,{method:"PUT",body:o}));case 16:r=l.sent,console.log("Result: ",r),this.uploadURL=e.data.uploadURL.split("?")[0],console.log("checkStatus"),i=0,s={};case 22:return l.next=24,regeneratorRuntime.awrap(w()({method:"GET",url:"".concat(this.$API,"/checkstatus?photoFilename=").concat(this.photoFilename)}));case 24:return s=l.sent,console.log("Request status: ",s),l.next=28,regeneratorRuntime.awrap(this.sleep(1e3));case 28:if(!s.data){l.next=30;break}return l.abrupt("break",32);case 30:i++;case 31:if(i<10){l.next=22;break}case 32:this.modalText=this.resultText[s.data.result],this.modalShow=!0;case 34:case"end":return l.stop()}}),null,this)},cleanUp:function(){this.sendButtonText="Send Photo",this.isSending=!1,this.photoFilename="",this.modalText="",this.modalShow=!1,this.$router.push("/")},sleep:function(e){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return setTimeout(t,e)})));case 1:case"end":return t.stop()}}))}}},T=S,_=Object(l["a"])(T,v,y,!1,null,null,null),k=_.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{name:"verify"}},[a("img",{staticClass:"mt-4 img-fluid",attrs:{src:e.image}}),a("b-card",{staticClass:"text-center",attrs:{title:"Verify member","bg-variant":"primary light fixed-bottom","text-variant":"white"}},[a("div",{staticClass:"innerBox d-flex justify-content-center flex-column"},[a("div",{attrs:{disabled:e.isSending}},[a("b-button",{attrs:{size:"lg",disabled:e.isSending,variant:"success",block:"",href:"#",type:"file"},on:{click:function(t){return e.$refs.file.click()}}},[e._v(e._s(e.sendButtonText))]),a("input",{ref:"file",staticStyle:{display:"none"},attrs:{id:"file",accept:"image/jpeg",type:"file"},on:{change:e.onFileChange}}),a("b-button",{attrs:{to:{name:"home"},size:"lg",disabled:e.isSending,variant:"secondary",block:""}},[e._v("Cancel")])],1)]),a("b-modal",{attrs:{centered:"","cancel-disabled":"","no-close-on-esc":"","no-close-on-backdrop":"","header-text-variant":"primary","body-text-variant":"primary",id:"modal",size:"sm",title:"Face Matcher"},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[e._v(" "+e._s(e.modalText)+" "),a("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("b-button",{staticClass:"float-right",attrs:{size:"sm",variant:"primary"},on:{click:e.cleanUp}},[e._v("Close")])],1)])],1)],1)},P=[],O={name:"Verify",data:function(){return{image:"",sendButtonText:"Send Photo",isSending:!1,photoFilename:"",modalText:"",modalShow:!1}},methods:{onFileChange:function(e){var t=e.target.files||e.dataTransfer.files;t.length&&this.createImage(t[0])},createImage:function(e){var t=this;console.log("createImage: ",e);var a=new FileReader,n=5e6;a.onload=function(e){return e.target.result.includes("data:image/jpeg")?e.target.result.length>n?alert("Photo too large - max size of 5Mb"):(t.image=e.target.result,void t.uploadImage()):alert("Wrong photo type - only JPG allowed.")},a.readAsDataURL(e)},uploadImage:function(){var e,t,a,n,o,r,i,s,l;return regeneratorRuntime.async((function(c){while(1)switch(c.prev=c.next){case 0:return console.log("uploadImage started: ",this.image),this.isSending=!0,this.sendButtonText="Uploading...",c.next=5,regeneratorRuntime.awrap(w()({method:"GET",url:"".concat(this.$API,"/upload?mode=verify")}));case 5:for(e=c.sent,console.log("Response: ",e.data),console.log("Uploading: ",this.image),t=atob(this.image.split(",")[1]),a=[],n=0;n<t.length;n++)a.push(t.charCodeAt(n));return o=new Blob([new Uint8Array(a)],{type:"image/jpeg"}),this.photoFilename=e.data.photoFilename,console.log("Uploading to: ",e.data.uploadURL),c.next=16,regeneratorRuntime.awrap(fetch(e.data.uploadURL,{method:"PUT",body:o}));case 16:r=c.sent,console.log("Result: ",r),console.log("checkStatus"),i=0,s={};case 21:return c.next=23,regeneratorRuntime.awrap(w()({method:"GET",url:"".concat(this.$API,"/checkstatus?photoFilename=").concat(this.photoFilename)}));case 23:return s=c.sent,console.log("Request status: ",s),c.next=27,regeneratorRuntime.awrap(this.sleep(1e3));case 27:if(!s.data){c.next=29;break}return c.abrupt("break",31);case 29:i++;case 30:if(i<10){c.next=21;break}case 31:c.t0=s.data.result,c.next="MATCH"===c.t0?34:"NO_MATCH"===c.t0?40:"NO_FACES"===c.t0?42:44;break;case 34:return console.log(s.data),l=s.data.rekognition.FaceMatches[0].Face.ExternalImageId,this.modalText="Success! You are a member. This is your original member photo:",this.image="".concat(this.$PHOTOS_URL,"/").concat(l),console.log("".concat(this.$PHOTOS_URL,"/").concat(l)),c.abrupt("break",44);case 40:return this.modalText="You are NOT a member.",c.abrupt("break",44);case 42:return this.modalText="There is no face in this photo.",c.abrupt("break",44);case 44:this.modalShow=!0;case 45:case"end":return c.stop()}}),null,this)},cleanUp:function(){this.sendButtonText="Send Photo",this.isSending=!1,this.photoFilename="",this.modalText="",this.modalShow=!1},sleep:function(e){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return setTimeout(t,e)})));case 1:case"end":return t.stop()}}))}}},C=O,F=Object(l["a"])(C,R,P,!1,null,null,null),U=F.exports;n["default"].use(d["a"]);var I=new d["a"]({mode:"history",routes:[{path:"*",name:"home",component:b},{path:"/verify",name:"verify",component:U},{path:"/enroll",name:"enroll",component:k}]}),j=a("5f5b"),A=(a("f9e3"),a("2dd8"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"primary fixed-top"}},[a("b-navbar-brand",{attrs:{href:"#"}},[e._v("Face Matcher")]),a("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),a("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[a("b-navbar-nav",[a("b-nav-item",{attrs:{to:{name:"enroll"}}},[e._v("Enroll")]),a("b-nav-item",{attrs:{to:{name:"verify"}}},[e._v("Verify")])],1)],1)],1)}),E=[],$={name:"Nav"},M=$,z=Object(l["a"])(M,A,E,!1,null,null,null),B=z.exports;n["default"].config.productionTip=!1,n["default"].use(j["a"]),n["default"].component("Nav",B),n["default"].prototype.$API="https://q2utpqquq3.execute-api.us-east-1.amazonaws.com/Prod",n["default"].prototype.$PHOTOS_URL="https://facial-recognition-s3.s3.amazonaws.com/enroll",new n["default"]({el:"#app",render:function(e){return e(u)},router:I,components:{App:u},template:"<App/>"}).$mount("#app")},"85ec":function(e,t,a){}});
//# sourceMappingURL=app.c879eba0.js.map